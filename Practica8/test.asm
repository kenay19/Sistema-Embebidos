LIST P=16F887
#INCLUDE <P16F887.INC>
	__CONFIG    _CONFIG1, _LVP_OFF & _FCMEN_ON & _IESO_OFF & _BOR_OFF & _CPD_OFF & _CP_OFF & _MCLRE_ON & _PWRTE_ON & _WDT_OFF & _INTRC_OSC_NOCLKOUT
	__CONFIG    _CONFIG2, _WRT_OFF & _BOR21V
	ORG     0x000
CONT 		EQU 	0x6F
OPC         EQU     0x2F
CounterC    EQU     0x3F
CounterB   	EQU     0x4F
CounterA    EQU     0x5F
confi		BSF   STATUS,RP0
			MOVLW b'00000011'       ;
			MOVWF TRISA		 ;
			MOVLW 0x00		 ;
			MOVWF TRISD
			MOVWF TRISB
			MOVWF TRISC
			BSF   STATUS,RP1 ;
			CLRF ANSEL 	 ;
			CLRF ANSELH	 ; 
			BCF STATUS,RP0;
			BCF	 STATUS,RP1;
			CLRF PORTD ;
			CLRF PORTA	;
			CLRF PORTB	;
			CLRF PORTC	;
			MOVLW D'6'
			MOVWF OPC

INICIO  	BTFSS PORTA,1 ;
			GOTO  MOTOR0
			GOTO  MOTOR1

MOTOR0   	BTFSS PORTA,0;
		 	GOTO  MOTOR0DER
		 	GOTO  MOTOR0IZQ

MOTOR1   	BTFSS PORTA,0;
		 	GOTO  MOTOR1DER
		 	GOTO  MOTOR1IZQ

MOTOR0DER 	MOVLW B'00000001'
			MOVWF PORTD
			DECFSZ OPC,0
			CALL  CHANGEOPC1
			MOVFW CONT
			CALL  M1_DERB
			MOVWF PORTB
			MOVFW CONT
			CALL  M1_DERC
			MOVWF PORTC
			INCF  CONT,1
			CALL  RETRASOS
			MOVLW D'9'
			SUBWF CONT,1
			DECFSZ CONT,0
			GOTO   REM1DER
			MOVLW D'2'
			MOVWF OPC
			GOTO  INICIO


REM1DER   MOVLW D'9'
		  ADDWF CONT,1
		  GOTO INICIO

CHANGEOPC1  MOVLW D'0'
			MOVWF CONT
			MOVLW D'1'
			MOVWF OPC
			MOVLW 0xFF
			MOVWF PORTB
			MOVWF PORTC
			RETURN


MOTOR0IZQ	MOVLW B'00000010'
			MOVWF PORTD
			DECF   OPC,1
			DECFSZ OPC,0
			CALL  CHANGEOPC2
			MOVFW CONT
			CALL  M1_IZQB
			MOVWF PORTB
			MOVFW CONT
			CALL  M1_IZQC
			MOVWF PORTC
			INCF  CONT,1
			CALL  RETRASOS
			MOVLW D'11'
			SUBWF CONT,1
			DECFSZ CONT,0
			GOTO   REM1IZQ
			MOVLW D'4'
			MOVWF OPC
			GOTO  INICIO

CHANGEOPC2  MOVLW D'0'
			MOVWF CONT
			MOVLW D'2'
			MOVWF OPC
			MOVLW 0xFF
			MOVWF PORTB
			MOVWF PORTC
			RETURN

REM1IZQ   	MOVLW D'11'
		  	ADDWF CONT,1
			MOVLW D'2'
			MOVWF OPC
		  	GOTO INICIO



MOTOR1DER 	MOVLW B'00000100'
			MOVWF PORTD
			DECF   OPC,1
			DECF   OPC,1
			DECFSZ OPC,0
			CALL  CHANGEOPC3
			MOVFW CONT
			CALL  M2_DERB
			MOVWF PORTB
			MOVFW CONT
			CALL  M2_DERC
			MOVWF PORTC
			INCF  CONT,1
			CALL  RETRASOS
			MOVLW D'9'
			SUBWF CONT,1
			DECFSZ CONT,0
			GOTO   REM3DER
			MOVLW D'2'
			MOVWF OPC
			GOTO  INICIO


REM3DER   MOVLW D'9'
		  ADDWF CONT,1
			MOVLW D'3'
			MOVWF OPC
		  GOTO INICIO

CHANGEOPC3  MOVLW D'0'
			MOVWF CONT
			MOVLW D'3'
			MOVWF OPC
			MOVLW 0xFF
			MOVWF PORTB
			MOVWF PORTC
			RETURN

; =========================== Motor 2 Izquierdo ===============================

MOTOR1IZQ	MOVLW B'00001000'
			MOVWF PORTD
			MOVLW D'3'
			SUBWF OPC,1
			DECFSZ OPC,0
			CALL  CHANGEOPC4
			MOVFW CONT
			CALL  M2_IZQB
			MOVWF PORTB
			MOVFW CONT
			CALL  M2_IZQC
			MOVWF PORTC
			INCF  CONT,1
			CALL  RETRASOS
			MOVLW D'11'
			SUBWF CONT,1
			DECFSZ CONT,0
			GOTO   REM2IZQ
			MOVLW D'3'
			MOVWF OPC
			GOTO  INICIO

CHANGEOPC4  MOVLW D'0'
			MOVWF CONT
			MOVLW D'4'
			MOVWF OPC
			MOVLW 0xFF
			MOVWF PORTB
			MOVWF PORTC
			RETURN

REM2IZQ   	MOVLW D'11'
		  	ADDWF CONT,1
			MOVLW D'4'
			MOVWF OPC
		  	GOTO INICIO


; =================================== Tablas =======================================================

M1_DERB		ADDWF PCL,F
			;       HGFEDCBA
			RETLW B'00110011' ; M
			RETLW B'11111111' ; 1
			RETLW B'11001111' ; _
			RETLW B'11000000' ; D
			RETLW B'00001100' ; E
			RETLW B'00111000' ; R
			RETLW B'00001100' ; E
			RETLW B'00001100' ; C
			RETLW B'00110011' ; H
			RETLW B'00000000' ; 0

M1_DERC		ADDWF PCL,F
			;  		LNOPMKJI
			RETLW B'11111010' ; M
			RETLW B'11011101' ; 1
			RETLW B'11111111' ; _
			RETLW B'11011101' ; D
			RETLW B'01110111' ; E
			RETLW B'01100111' ; R
			RETLW B'01110111' ; E
			RETLW B'11111111' ; C
			RETLW B'01110111' ; H
			RETLW B'11111111' ; 0   



M2_DERB		ADDWF PCL,F
			;       HGFEDCBA
			RETLW B'00110011' ; M
			RETLW B'10001000' ; 2
			RETLW B'11001111' ; _
			RETLW B'11000000' ; D
			RETLW B'00001100' ; E
			RETLW B'00111000' ; R
			RETLW B'00001100' ; E
			RETLW B'00001100' ; C
			RETLW B'00110011' ; H
			RETLW B'00000000' ; 0

M2_DERC		ADDWF PCL,F
			;  		LNOPMKJI
			RETLW B'11111010' ; M
			RETLW B'01110111' ; 2
			RETLW B'11111111' ; _
			RETLW B'11011101' ; D
			RETLW B'01110111' ; E
			RETLW B'01100111' ; R
			RETLW B'01110111' ; E
			RETLW B'11111111' ; C
			RETLW B'01110111' ; H
			RETLW B'11111111' ; 0 


M1_IZQB		ADDWF PCL,F
			;       HGFEDCBA
			RETLW B'00110011' ; M
			RETLW B'11111111' ; 1
			RETLW B'11001111' ; _
			RETLW B'11001100' ; I
			RETLW B'11001100' ; Z
			RETLW B'00000000' ; Q
			RETLW B'00000011' ; U
			RETLW B'11001100' ; I
			RETLW B'00001100' ; E
			RETLW B'00111000' ; R
			RETLW B'11000000' ; D
			RETLW B'00000000' ; 0
M1_IZQC		ADDWF PCL,F
			;  		LNOPMKJI
			RETLW B'11111010' ; M
			RETLW B'11011101' ; 1
			RETLW B'11111111' ; _
			RETLW B'11011101' ; I
			RETLW B'10111011' ; Z
			RETLW B'11101111' ; Q
			RETLW B'11111111' ; U
			RETLW B'11011101' ; I
			RETLW B'01110111' ; E
			RETLW B'01100111' ; R
			RETLW B'11011101' ; D
			RETLW B'11111111' ; 0   



M2_IZQB		ADDWF PCL,F
			;       HGFEDCBA
			RETLW B'00110011' ; M
			RETLW B'10001000' ; 2
			RETLW B'11001111' ; _
			RETLW B'11001100' ; I
			RETLW B'11001100' ; Z
			RETLW B'00000000' ; Q
			RETLW B'00000011' ; U
			RETLW B'11001100' ; I
			RETLW B'00001100' ; E
			RETLW B'00111000' ; R
			RETLW B'11000000' ; D
			RETLW B'00000000' ; 0

M2_IZQC		ADDWF PCL,F
			;  		LNOPMKJI
			RETLW B'11111010' ; M
			RETLW B'01110111' ; 1
			RETLW B'11111111' ; _
			RETLW B'11011101' ; I
			RETLW B'10111011' ; Z
			RETLW B'11101111' ; Q
			RETLW B'11111111' ; U
			RETLW B'11011101' ; I
			RETLW B'01110111' ; E
			RETLW B'01100111' ; R
			RETLW B'11011101' ; D
			RETLW B'11111111' ; 0

RETRASOS MOVLW D'3'
		MOVWF	CounterC
		MOVLW	D'22'
		MOVWF	CounterB
		MOVLW	D'233'
		MOVWF	CounterA
loop    DECFSZ	CounterA,1
		GOTO	loop
		DECFSZ	CounterB,1
		GOTO	loop 
		DECFSZ	CounterC,1
		GOTO	loop
		RETURN
			END
